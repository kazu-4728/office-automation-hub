# コスト戦略

## 予算設定
- 月額上限: $2.00
- 通常運用: $0/月（Claudeメイン）
- 大規模処理時のみ: $1-2/月

## コスト配分

### 月額$2での配分
- Gemini Flash（メイン）: $1.00
- Gemini Pro（重要ページ）: $0.50
- ストレージ（R2）: $0.10
- 予備: $0.40

### 変換可能量（月額$2）
- Gemini Flash: 約350万文字（700ページ）
- Gemini Pro: 約35万文字（70ページ）
- 実用目安: 100-150ページ/月

## 最適化戦略

### 1. 自動モデル選択
```typescript
function selectModel(content: string) {
  const complexity = analyzeComplexity(content)
  
  if (complexity === 'high') {
    return 'gemini-pro'      // 専門的・複雑
  } else {
    return 'gemini-flash'    // 一般的・シンプル
  }
}
```

### 2. キャッシング徹底
- 同じページの2回目以降: $0
- 設定変更のみ: $0
- プロンプト調整: 差分のみAPI

### 3. ローカル処理活用
- Mermaid図解生成: $0
- HTMLテンプレート: $0
- 画像最適化: $0

## コスト見積もり例

### 1ページ変換
```
入力: 5,000文字
モデル: Gemini Flash
コスト: $0.02
時間: 15秒
```

### 10ページ変換
```
入力: 50,000文字
モデル: Flash 9ページ + Pro 1ページ
コスト: $0.25
時間: 3分
```

### 50ページ変換
```
入力: 250,000文字
モデル: Flash 45ページ + Pro 5ページ
コスト: $1.20
時間: 15分
```

## 警告・制限

### 予算警告
- $1.80到達: 警告表示
- $2.00到達: 自動停止

### レート制限
- 同一サイト: 1秒間隔
- API制限: 60req/min
- 並列処理: 制限内で実行