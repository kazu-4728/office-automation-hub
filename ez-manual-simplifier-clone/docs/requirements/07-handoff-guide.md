# 引き継ぎガイド

## このドキュメントの目的
他のAIエージェントがこのプロジェクトを理解し、継続して作業できるようにするためのガイドです。

## プロジェクト概要
- **名前**: ez-manual-simplifier
- **目的**: 複雑な技術マニュアルを分かりやすく変換
- **技術**: AI駆動、コスト最適化、テンプレート化
- **予算**: 月額$2以下

## 重要な設計原則

### 1. モジュール独立性
- 各モジュールは独立して動作
- 1つが壊れても他に影響しない
- 個別にテスト・デバッグ可能

### 2. コスト最適化
- 通常運用: $0/月（Claudeメイン）
- 大規模処理時のみ: $1-2/月（Gemini API）
- キャッシング徹底でAPI使用最小化

### 3. テンプレート化
- 毎回同じ構造で出力
- デザインの統一性
- 再利用性の向上

## ディレクトリ構造

```
ez-manual-simplifier/
├── modules/                    # 機能モジュール
│   ├── 00-cost-estimator/     # コスト管理
│   ├── 01-input/              # 入力処理
│   ├── 02-converter/          # 変換処理
│   ├── 03-output/             # 出力処理
│   └── 04-storage/            # ストレージ
├── templates/                 # HTMLテンプレート
├── docs/                     # ドキュメント
└── output/                   # 生成結果
```

## 各モジュールの責務

### 00-cost-estimator/
- コスト見積もり
- 予算管理
- 無料/有料判定

### 01-input/url-handler/
- URLスクレイピング
- HTML解析
- サイト別最適化

### 02-converter/claude-converter/
- テキスト平易化
- 構造整理
- 図解・具体例生成

### 03-output/
- HTMLテンプレート適用
- ディレクトリ生成
- ファイル配置

### 04-storage/
- キャッシュ管理
- ファイル保存
- メタデータ記録

## 作業フロー

### 基本的な流れ
1. URL入力
2. コスト見積もり
3. ユーザー承認
4. スクレイピング
5. 変換処理
6. テンプレート適用
7. ファイル生成
8. 結果報告

### エラーハンドリング
- エラーは発生したモジュール内で処理
- 部分的な結果でも出力
- 詳細なエラーログを記録

## 技術スタック

### メイン技術
- **変換**: Claude（無料）
- **レビュー**: Codex
- **補助**: Gemini API（必要時のみ）
- **出力**: HTML + CSS + JavaScript
- **ホスティング**: Cloudflare Pages

### 重要なライブラリ
- スクレイピング: fetch, cheerio, puppeteer
- 図解: Mermaid
- テンプレート: 自作テンプレートエンジン
- ストレージ: Cloudflare R2

## コスト管理

### 予算設定
- 月額上限: $2.00
- 通常運用: $0/月
- 大規模処理時のみ: $1-2/月

### 最適化戦略
- 自動モデル選択（Pro/Flash）
- キャッシング徹底
- ローカル処理活用

## 品質管理

### レビューポイント
- コード品質
- エラーハンドリング
- パフォーマンス
- セキュリティ

### テスト項目
- 単体テスト
- 統合テスト
- エンドツーエンドテスト
- コスト検証

## トラブルシューティング

### よくある問題

#### 1. スクレイピング失敗
- robots.txt確認
- レート制限確認
- 別のスクレイピング方法を試す

#### 2. 変換品質が低い
- プロンプト調整
- モデル選択見直し
- 手動調整

#### 3. コスト超過
- キャッシュ活用
- モデル選択見直し
- 処理量削減

#### 4. テンプレートエラー
- 変数名確認
- テンプレート構文確認
- データ構造確認

## 開発ガイドライン

### コード品質
- 各モジュールにREADME.md必須
- エラーハンドリング必須
- テストコード必須
- コメント充実

### ドキュメント
- 変更時は即座に更新
- 具体例を豊富に含める
- 他のAIが理解できる記述

### バージョン管理
- 機能追加は新しいブランチ
- レビュー必須
- テスト通過後マージ

## 緊急時の対応

### システム障害時
1. エラーログ確認
2. 影響範囲特定
3. 該当モジュール修正
4. テスト実行
5. 再実行

### 予算超過時
1. 処理停止
2. 原因分析
3. 設定調整
4. 再開

### 品質問題時
1. 問題箇所特定
2. 修正実装
3. テスト実行
4. 再デプロイ

## 連絡先・リソース

### ドキュメント
- このリポジトリのdocs/フォルダ
- 各モジュールのREADME.md
- コメント・コード内の説明

### 外部リソース
- Cloudflare Pages: ホスティング
- Gemini API: 変換処理
- Mermaid: 図解生成

## 最後に

このプロジェクトは「複雑な技術文書を分かりやすくする」という明確な目的があります。コストを抑えながら、高品質な出力を維持することが重要です。

何か不明な点があれば、このドキュメントを参照し、段階的に理解を深めてください。急がず、確実に進めることが成功の鍵です。